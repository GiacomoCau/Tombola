<!DOCTYPE html>

<html>
<head>
	<title>Schede</title>
	<meta charset="windows-1252" />
</head>

<body style="font-family:Courier New; font-size:9pt">

<script>
	document.write(new Date().getTime(), '<br><br>')
	
	function R(c, rs) { // c:#colonne, r:sum(v) 
		return Rn(c, rs, [])
		
		function* Rn(c, rs, v) {
			if (c == 1) {
				//if (r < 0) return
				yield v.concat(rs)
				return 
			}
			for (var n=rs<c?0:1; n<=1; n+=1) { // se totale di riga < colonne rimanenti ? 0 : mx-
				var rsn = rs-n
				if (rsn < 0) break
				yield* Rn(c-1, rsn, v.concat(n))
			}
		}
	}
	
	//var i=0; for (var v of R(5,3)) document.write(i+=1, ') ', v, '<br>')
	
	function T(z, s, r, rs) {
		var c = z.length
		var vs=[]; for (var v of R(c, rs)) vs.push(v)
		return Z(z, s, [])
		
		function* Z(z, s, t) {
			if (s == 0) {
				for (n of z) 
					if (n)
						return
				yield t
			}
			else for (var m of M(z, c, Array(c).fill(0), r, [])) {
				var nz = sub(z, m)
				if (!nz)
					continue
				yield* Z(nz, s-1, t.concat( [m] ))
			}	
			function sub(z, m) {
				var r=[]; for (var n of z) r.push(n)
				for (var v of m)
					for (var i=0, e=v.length; i<e; i+=1)
						if ((r[i]-=v[i]) < 0) 
							return
				return r
			}
		}
		
		function* M(z, c, cs, r, m) {
			if (r == 0) {
				if (cs.indexOf(0) == -1)
					yield m 
			}
			else for (var v of vs) {
				var nz = sub(z, v)
				if (!nz)
					continue
				var ncs = sum(cs, v)
				yield* M(nz, c, ncs, r-1, m.concat( [v] ))
			}
			function sub(a, b) {
				for (var r=[], i=0, e=a.length; i<e; i+=1)
					if ((r[i]=a[i]-b[i])<0)
						return
				return r
			}
			function sum(a, b) {
				for (var r=[], i=0, e=a.length; i<e; i+=1)
					r[i]=a[i]+b[i]
				return r
			}
		}
	}
	
	
	var i=0
	//for (var t of T([9,10,10,10,10,10,10,10,11], 6, 3, 5)) {
	for (var t of T([3,4,4,4,4,5], 2, 3, 4)) {
		//if (i==10) break
		document.write('<div style="float:left; margin-right:10px; margin-bottom:10px">')
		document.write(i+=1, ') <br>')
		for (var m of t) {
			for (var r of m) document.write(r, '<br>')
			document.write('<br>')
		}
		document.write('</div>')
	}	

</script>

</body>
</html>
